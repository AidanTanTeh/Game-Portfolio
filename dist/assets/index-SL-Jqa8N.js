(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();class u{constructor(t=0,e=0){this.x=t,this.y=e}duplicate(){return new u(this.x,this.y)}}class Mt{constructor(t,e){this.lastFrameTime=0,this.accumulatedTime=0,this.timeStep=1e3/60,this.update=t,this.render=e,this.rafId=null,this.isRunning=!1}mainLoop=t=>{if(!this.isRunning)return;let e=t-this.lastFrameTime;for(this.lastFrameTime=t,this.accumulatedTime+=e;this.accumulatedTime>=this.timeStep;)this.update(this.timeStep),this.accumulatedTime-=this.timeStep;this.render(),this.rafId=requestAnimationFrame(this.mainLoop)};start(){this.isRunning||(this.isRunning=!0,this.rafId=requestAnimationFrame(this.mainLoop))}stop(){this.rafId&&cancelAnimationFrame(this.rafId),this.isRunning=!1}}const Y="LEFT",B="RIGHT",U="DOWN";class Pt{constructor(){this.heldDirections=[],this.jumpPressed=!1,this.jumpHeld=!1,document.addEventListener("keydown",t=>{(t.code==="ArrowLeft"||t.code==="KeyA")&&this.onArrowPressed(Y),(t.code==="ArrowRight"||t.code==="KeyD")&&this.onArrowPressed(B),(t.code==="ArrowUp"||t.code==="KeyW"||t.code==="Space")&&(t.preventDefault(),this.jumpHeld||(this.jumpPressed=!0,this.jumpHeld=!0))}),document.addEventListener("keyup",t=>{(t.code==="ArrowLeft"||t.code==="KeyA")&&this.onArrowReleased(Y),(t.code==="ArrowRight"||t.code==="KeyD")&&this.onArrowReleased(B),(t.code==="ArrowUp"||t.code==="KeyW"||t.code==="Space")&&(this.jumpHeld=!1)})}get direction(){return this.heldDirections[0]}onArrowPressed(t){this.heldDirections.indexOf(t)===-1&&this.heldDirections.unshift(t)}onArrowReleased(t){const e=this.heldDirections.indexOf(t);e!==-1&&this.heldDirections.splice(e,1)}clearFrameInputs(){this.jumpPressed=!1}}const vt=16,E=n=>n*vt,ht=(n,t,e)=>{const i=Math.round(t/16)*16,s=Math.round(e/16)*16;return!n.has(`${i},${s}`)};class It{callbacks=[];nextId=0;emit(t,e){this.callbacks.forEach(i=>{i.eventName===t&&i.callback(e)})}on(t,e,i){return this.nextId+=1,this.callbacks.push({id:this.nextId,eventName:t,caller:e,callback:i}),this.nextId}off(t){this.callbacks=this.callbacks.filter(e=>e.id!==t)}unsubscribe(t){this.callbacks=this.callbacks.filter(e=>e.caller!=t)}}const g=new It;class v{constructor({position:t}){this.position=t??new u(0,0),this.children=[],this.parent=null,this.drawLayer=0}stepEntry(t,e){this.children.forEach(i=>i.stepEntry(t,e)),this.step(t,e)}step(t){}draw(t,e,i){const s=Math.round(e+this.position.x),o=Math.round(i+this.position.y);this.drawImage(t,s,o),this.children.slice().sort((r,a)=>r.drawLayer-a.drawLayer).forEach(r=>r.draw(t,s,o))}drawImage(t,e,i){}destroy(){this.children.forEach(t=>{t.destroy()}),this.parent.removeChild(this)}addChild(t){t.parent=this,this.children.push(t)}removeChild(t){console.log("gameObject removeChild",t),g.unsubscribe(t),this.children=this.children.filter(e=>t!==e)}getWorldPosition(){let t=0,e=0,i=this;for(;i;)t+=i.position.x,e+=i.position.y,i=i.parent;return new u(t,e)}}class _ extends v{constructor({resource:t,frameSize:e,hFrames:i,vFrames:s,frame:o,scale:r,position:a,animations:h,rotation:c,pivot:l,flipX:d}){super({}),this.resource=t,this.frameSize=e??new u(16,16),this.hFrames=i??1,this.vFrames=s??1,this.frame=o??0,this.frameMap=new Map,this.scale=r??1,this.position=a??new u(0,0),this.animations=h??null,this.buildFrameMap(),this.rotation=c??0,this.pivot=l??new u(0,0),this.flipX=d??!1}buildFrameMap(){let t=0;for(let e=0;e<this.vFrames;e++)for(let i=0;i<this.hFrames;i++)this.frameMap.set(t,new u(this.frameSize.x*i,this.frameSize.y*e)),t++}step(t){this.animations&&(this.animations.step(t),this.frame=this.animations.frame)}drawImage(t,e,i){if(!this.resource.isLoaded)return;let s=0,o=0;const r=this.frameMap.get(this.frame);r&&(s=r.x,o=r.y);const a=this.frameSize.x,h=this.frameSize.y;if(this.rotation===0&&!this.flipX){t.drawImage(this.resource.image,s,o,a,h,e,i,a*this.scale,h*this.scale);return}t.save();const c=a*this.scale,l=h*this.scale,d=this.pivot.x*this.scale,p=this.pivot.y*this.scale;t.translate(Math.round(e+d),Math.round(i+p)),t.rotate(this.rotation),this.flipX&&t.scale(-1,1),t.drawImage(this.resource.image,s,o,a,h,-d,-p,c,l),t.restore()}}class Lt{constructor(){this.toLoad={hero:"./sprites/hero-sheet.png",ground:"./sprites/ground4.png",sky:"./sprites/sky.png",gunPickup:"./sprites/gunGreyPickup.png",gunHeld:"./sprites/gunGreyHeld.png",boxSheet:"./sprites/boxsheet2.png",bbIntro:"./sprites/me.png",bbAbout:"./sprites/mcd.png",bbProjects:"./sprites/snapfit.png",bbHobbies:"./sprites/climbing.png",bbGames:"./sprites/gamerSeal.png"},this.images={},Object.keys(this.toLoad).forEach(t=>{const e=new Image;e.src=this.toLoad[t],this.images[t]={image:e,isLoaded:!1},e.onload=()=>{this.images[t].isLoaded=!0}})}}const O=new Lt;class R{constructor(t){this.currentTime=0,this.animationConfig=t,this.duration=t.duration??500}get frame(){const{frames:t}=this.animationConfig;for(let e=t.length-1;e>=0;e--)if(this.currentTime>=t[e].time)return t[e].frame;throw"Time is before the first keyframe"}step(t){this.currentTime+=t,this.currentTime>=this.duration&&(this.currentTime=0)}}const F=(n=0)=>({duration:400,frames:[{time:0,frame:n}]}),N=(n=0)=>({duration:400,frames:[{time:0,frame:n+1},{time:100,frame:n},{time:200,frame:n+1},{time:300,frame:n+2}]}),Rt=F(10),Et=F(4),Tt=F(7),kt=F(1),At=N(9),Wt=N(3),Ot=N(6),xt=N(0),Ct={duration:400,frames:[{time:0,frame:12}]};class lt{constructor(t){this.patterns=t,this.activeKey=Object.keys(this.patterns)[0]}get frame(){return this.patterns[this.activeKey].frame}play(t,e=0){this.activeKey!==t&&(this.activeKey=t,this.patterns[this.activeKey].currentTime=e)}step(t){this.patterns[this.activeKey].step(t)}}const dt=new Set,ct=320,Xt=180,Ht=2500,V=0,G=Ht,P=E(10),Dt=900,Yt=-320;class Bt extends v{constructor(t,e){super({position:new u(t,e)}),this.velocityX=80,this.velocityY=0,this.isGrounded=!0,this.drawLayer=11,this.normalDrawLayer=this.drawLayer,this.wasGrounded=this.isGrounded,this.justLanded=!1,this.inPipe=!1,this.pipeTime=0,this.pipeDuration=800,this.pipeTargetX=0,this.pipeSnapTime=0,this.pipeSnapDuration=120,this.pipeStartY=0,this.pipeEndY=0,this.body=new _({resource:O.images.hero,frameSize:new u(32,32),hFrames:3,vFrames:8,frame:1,position:new u(-16,-29),animations:new lt({walkDown:new R(xt),walkUp:new R(Ot),walkLeft:new R(At),walkRight:new R(Wt),standDown:new R(kt),standUp:new R(Tt),standLeft:new R(Rt),standRight:new R(Et),pickUpDown:new R(Ct)})}),this.addChild(this.body),this.handAnchor=new v({position:new u(6,-20)}),this.addChild(this.handAnchor),this.heldWeapon=null,this.facingDirection=U,this.itemPickupTime=0,this.itemPickupShell=null,this.shootCooldownMs=0,this.fireRateMs=400,g.on("HERO_PICKS_UP_ITEM",this,i=>{this.onPickUpItem(i)})}step(t,e){if(this.inPipe){if(this.pipeSnapTime>0){this.pipeSnapTime-=t;const p=1-Math.max(0,this.pipeSnapTime)/this.pipeSnapDuration,f=1-Math.pow(1-p,3);this.position.y=this.pipeStartY;const m=this.position.x,w=this.pipeTargetX;this.position.x=m+(w-m)*f,this.tryEmitPosition();return}this.position.x=this.pipeTargetX,this.pipeTime-=t;const l=1-Math.max(0,this.pipeTime)/this.pipeDuration,d=l*l;this.position.y=this.pipeStartY+(this.pipeEndY-this.pipeStartY)*d,this.tryEmitPosition();return}if(this.itemPickupTime>0){this.workOnItemPickup(t);return}const{input:i}=e,s=t/1e3;let o=0;i.direction===Y?o=-1:i.direction===B&&(o=1),i.jumpPressed&&this.isGrounded&&(this.velocityY=Yt,this.isGrounded=!1),this.velocityY+=Dt*s,i.direction?(i.direction===Y&&this.body.animations.play("walkLeft"),i.direction===B&&this.body.animations.play("walkRight"),i.direction===U&&this.body.animations.play("walkDown"),this.facingDirection=i.direction):(this.facingDirection===Y&&this.body.animations.play("standLeft"),this.facingDirection===B&&this.body.animations.play("standRight"),this.facingDirection===U&&this.body.animations.play("standDown"));let r=this.position.x+o*this.velocityX*s,a=this.position.y+this.velocityY*s;r=Math.max(V,Math.min(G,r));const h=this.isGrounded;a>=P?(a=P,this.velocityY=0,this.isGrounded=!0):this.isGrounded=!1,this.justLanded=!h&&this.isGrounded,this.wasGrounded=this.isGrounded,ht(dt,r,a)?(this.position.x=r,this.position.y=a):this.position.y=a,this.shootCooldownMs=Math.max(0,this.shootCooldownMs-t),this.updateGunAim(e),this.tryShoot(e),this.tryEmitPosition()}tryEmitPosition(){this.lastX===this.position.x&&this.lastY===this.position.y||(this.lastX=this.position.x,this.lastY=this.position.y,g.emit("HERO_POSITION",this.position))}drawImage(t,e,i){}onPickUpItem({type:t,position:e}){this.itemPickupTime=800;const i=10,s=8;this.itemPickupShell=new v({}),this.itemPickupShell.addChild(new _({resource:O.images.gunPickup,frameSize:new u(i,s),position:new u(-3,-25)})),this.addChild(this.itemPickupShell),this.itemBeingPickedUp=t}workOnItemPickup(t){this.itemPickupTime-=t,this.body.animations.play("pickUpDown"),this.itemPickupTime<=0&&(this.itemPickupShell&&(this.removeChild(this.itemPickupShell),this.itemPickupShell=null),this.itemBeingPickedUp==="gun"&&this.equipGun(),this.itemBeingPickedUp=null)}equipGun(){this.heldWeapon&&(this.handAnchor.removeChild(this.heldWeapon),this.heldWeapon=null);const t=8,e=6,i=new _({resource:O.images.gunHeld,frameSize:new u(t,e),position:new u(-8,13),pivot:new u(2,3),rotation:0});this.handAnchor.addChild(i),this.heldWeapon=i,this.hasGun=!0}updateGunAim(t){if(!this.hasGun||!this.heldWeapon||!t.mouse)return;const e=this.handAnchor.getWorldPosition(),i=this.heldWeapon.position,s=this.heldWeapon.pivot,o=e.x+i.x+s.x,r=e.y+i.y+s.y,a=t.mouse.world.x-o,h=t.mouse.world.y-r,c=Math.atan2(h,a);this.aimAngle=c,this.heldWeapon.flipX=a<0;let l=c;this.heldWeapon.flipX&&(l+=Math.PI),this.heldWeapon.rotation=l}tryShoot(t){if(!this.hasGun||!this.heldWeapon||!t.mouse||!t.mouse.pressed||this.shootCooldownMs>0)return;const e=this.handAnchor.getWorldPosition(),i=this.heldWeapon.position,s=this.heldWeapon.pivot,o=e.x+i.x+s.x,r=e.y+i.y+s.y,a=this.aimAngle;if(a===void 0)return;const h=400,c=Math.cos(a)*h,l=Math.sin(a)*h,d=this.heldWeapon.rotation,p=this.heldWeapon.flipX,f=new u(6,-2),m=p?-f.x:f.x,w=f.y,b=Math.cos(d),M=Math.sin(d),S=b*m-M*w,I=M*m+b*w,T=o+S,K=r+I;g.emit("SPAWN_BULLET",{position:new u(T,K),velocity:new u(c,l)}),this.shootCooldownMs=this.fireRateMs}enterPipe(t,e){this.inPipe||(this.inPipe=!0,this.drawLayer=-5,this.pipeTargetX=t,this.pipeSnapTime=this.pipeSnapDuration,this.velocityY=0,this.isGrounded=!0,this.pipeStartY=e,this.pipeEndY=e+80,this.position.x=t,this.position.y=e,this.pipeTime=this.pipeDuration)}}class _t extends v{constructor(){super({}),g.on("HERO_POSITION",this,t=>{this.position=new u(Math.round(-t.x+160),0)})}}const et=125;class Gt extends v{constructor(){super({position:new u(0,P-et)}),this.tileWidth=185,this.tileHeight=180,this.surfaceOffset=et}drawImage(t,e,i){const s=O.images.ground;if(!s.isLoaded)return;const o=s.image,r=t.canvas.width,h=-(this.parent?.camera?.position.x??0),c=Math.floor((h-this.tileWidth)/this.tileWidth)*this.tileWidth,l=Math.ceil(r/this.tileWidth)+3;for(let d=0;d<l;d++)t.drawImage(o,c+d*this.tileWidth,i)}}const it=10,st=8;class Ft extends v{constructor(t,e){super({position:new u(t,e)});const i=new _({resource:O.images.gunPickup,frameSize:new u(it,st),position:new u(-it/2,-st)});this.addChild(i),g.on("HERO_POSITION",this,s=>{const o=Math.round(s.x),r=Math.round(s.y);o===this.position.x&&r===this.position.y&&(console.log("OVERLAP!"),this.onCollideWithHero())})}onCollideWithHero(){this.destroy(),g.emit("HERO_PICKS_UP_ITEM",{type:"gun",position:this.position})}drawImage(t,e,i){}}class Nt{constructor(t){this.canvas=t,this.screen=new u(0,0),this.world=new u(0,0),this.isDown=!1,this.pressed=!1,this.released=!1,t.addEventListener("mousemove",e=>this.onMove(e)),t.addEventListener("mousedown",()=>{this.isDown=!0,this.pressed=!0}),t.addEventListener("mouseup",()=>{this.isDown=!1,this.released=!0})}onMove(t){const e=this.canvas.getBoundingClientRect(),i=this.canvas.width/e.width,s=this.canvas.height/e.height;this.screen.x=(t.clientX-e.left)*i,this.screen.y=(t.clientY-e.top)*s}updateWorld(t){this.world.x=this.screen.x-t.position.x,this.world.y=this.screen.y-t.position.y}clearFrameInputs(){this.pressed=!1,this.released=!1}}function Kt(n,t){const e=Math.round(t.screen.x),i=Math.round(t.screen.y);n.save(),n.fillStyle="red",n.fillRect(e,i,1,1),n.fillRect(e-3,i,2,1),n.fillRect(e+2,i,2,1),n.fillRect(e,i-3,1,2),n.fillRect(e,i+2,1,2),n.restore()}function Ut(n,t){return n.x<t.x+t.w&&n.x+n.w>t.x&&n.y<t.y+t.h&&n.y+n.h>t.y}class zt extends v{constructor({position:t,velocity:e,lifeMs:i=900}){super({position:t}),this.velocity=e,this.lifeMs=i,this.w=2,this.h=2,this.drawLayer=11}step(t,e){const i=t/1e3,s=this.position.x+this.velocity.x*i,o=this.position.y+this.velocity.y*i;if(s<V-50||s>G+50){this.destroy();return}if(o>=P){this.destroy();return}if(!ht(dt,s,o)){this.destroy();return}this.position.x=s,this.position.y=o,this.lifeMs-=t,this.lifeMs<=0&&this.destroy();const a={x:this.position.x,y:this.position.y,w:this.w,h:this.h};for(const h of e.children){if(!h.isShootable||typeof h.getHitbox!="function")continue;const c=h.getHitbox();if(Ut(a,c)){typeof h.onBulletHit=="function"&&h.onBulletHit(),this.destroy();return}}}drawImage(t,e,i){t.fillStyle="grey",t.fillRect(e,i,this.w,this.h)}}const jt={duration:2500,frames:[{time:0,frame:0},{time:600,frame:1},{time:700,frame:2},{time:800,frame:3},{time:900,frame:4},{time:1e3,frame:5},{time:1100,frame:6},{time:1200,frame:7},{time:1300,frame:8},{time:1400,frame:9},{time:1500,frame:0}]};class $t extends v{constructor(t,e,i){super({position:new u(t,e)}),this.w=15,this.h=15,this.scale=1,this.sectionId=i,this.isShootable=!0,this.isDead=!1,this.drawLayer=1,this.bobTime=0,this.bobSpeed=1,this.bobAmount=2,this.sprite=new _({resource:O.images.boxSheet,frameSize:new u(this.w,this.h),hFrames:3,vFrames:4,frame:0,scale:this.scale,position:new u(-(this.w*this.scale)/2,-(this.h*this.scale)/2),animations:new lt({rotate:new R(jt)})}),this.addChild(this.sprite),this.sprite.animations.play("rotate")}getHitbox(){const t=this.getWorldPosition(),e=this.w*this.scale,i=this.h*this.scale;return{x:t.x-e/2,y:t.y-i/2,w:e,h:i}}drawImage(t,e,i){}step(t){this.bobTime+=t/1e3;const e=Math.sin(this.bobTime*Math.PI*2*this.bobSpeed)*this.bobAmount;this.sprite.position.y=-(this.h*this.scale/2)+e}onBulletHit(){if(this.isDead)return;this.isDead=!0;const t=this.getWorldPosition();g.emit("BOX_EXPLODE",{x:t.x,y:t.y,sectionId:this.sectionId}),this.destroy()}}class Vt extends v{constructor({x:t,y:e,vx:i,vy:s,colour:o,size:r,lifeMs:a}){super({position:new u(t,e)}),this.vx=i,this.vy=s,this.colour=o,this.size=r,this.lifeMs=a,this.maxLifeMs=a,this.drawLayer=100}step(t){const e=t/1e3;this.position.x+=this.vx*e,this.position.y+=this.vy*e,this.vx*=.98,this.vy*=.98,this.lifeMs-=t,this.lifeMs<=0&&this.destroy()}drawImage(t,e,i){const s=Math.max(0,this.lifeMs/this.maxLifeMs);t.save(),t.globalAlpha=s;const o=Math.max(1,this.size*s);t.fillStyle=this.colour,t.fillRect(e,i,o,o),t.restore()}}class qt extends v{constructor(t,e,i){super({position:new u(t,e)}),this.colour=i,this.spawned=!1,this.drawLayer=100}step(t){if(!this.spawned){this.spawned=!0;for(let e=0;e<25;e++){const i=(Math.random()-.5)*300,s=(Math.random()-.5)*300,o=e%2===0?this.colour:"#ff4400",r=1+Math.floor(Math.random()*5),a=300+Math.random()*400;e===0&&console.log("sample vx/vy:",i,s),this.parent.addChild(new Vt({x:this.position.x,y:this.position.y,vx:i,vy:s,colour:o,size:r,lifeMs:a}))}this.destroy()}}drawImage(t,e,i){t.save(),t.strokeStyle="orange",t.beginPath(),t.arc(e,i,this.radius,0,Math.PI*2),t.stroke(),t.restore()}}function Jt(n,t,e,i,s,o){const r=(t??"").split(" ");let a="",h=i;for(let c=0;c<r.length;c++){const l=a+r[c]+" ";n.measureText(l).width>s&&c>0?(n.fillText(a,e,h),a=r[c]+" ",h+=o):a=l}n.fillText(a,e,h)}class Zt extends v{constructor(t,e){super({position:new u(t,e)}),this.width=220,this.height=110,this.headerH=24,this.pad=10,this.title="PROJECTS",this.content="FitSnap is mobile fitness app that tracks your location on runs, tracking heart rate, speed, and distance.",this.imageKey=null,this.drawLayer=10}drawImage(t,e,i){const s=this.width,o=this.height;e=Math.round(e),i=Math.round(i);const r=Math.min(s/220,o/110),a=Math.max(2,Math.round(4*r)),h=Math.max(1,Math.round(2*r)),c=Math.max(14,Math.round(22*r)),l=Math.max(6,Math.round(10*r));t.fillStyle="rgba(0,0,0,0.28)",t.fillRect(e+6,i+6,s-2,o-2),t.fillStyle="#f1b51c",t.fillRect(e,i,s,o),t.fillStyle="#2b1b14",t.fillRect(e+a,i+a,s-a*2,o-a*2),t.fillStyle="#3a241d",t.fillRect(e+a+h,i+a+h,s-(a+h)*2,o-(a+h)*2);const d=e+a+h,p=i+a+h+c,f=s-(a+h)*2,m=o-(a+h)*2-c,w=t.createLinearGradient(0,p,0,p+m);w.addColorStop(0,"rgba(255,255,255,0.06)"),w.addColorStop(1,"rgba(0,0,0,0.12)"),t.fillStyle=w,t.fillRect(d,p,f,m),t.fillStyle="rgba(0,0,0,0.06)";for(let A=p;A<p+m;A+=3)t.fillRect(d,A,f,1);const b=Math.min(m-l*2,Math.round(42*r)),M=b,S=d+l,I=p+l,T=Math.max(1,Math.round(2*r));if(t.fillStyle="#d9d9d9",t.fillRect(S-T,I-T,M+T*2,b+T*2),t.fillStyle="#111",t.fillRect(S,I,M,b),this.imageKey){const A=O.images[this.imageKey];A&&A.isLoaded&&t.drawImage(A.image,S,I,M,b)}t.fillStyle="rgba(255,255,255,0.12)",t.fillRect(S,I,M,10),t.fillStyle="#f1b51c",t.fillRect(e+a+h,i+a+h,s-(a+h)*2,c);const K=Math.max(8,Math.round(10*r));t.fillStyle="#1a1a1a",t.font=`${K}px monospace`,t.textBaseline="middle",t.fillText(this.title,Math.round(d+l),Math.round(i+a+h+c/2));const ft=Math.max(6,Math.round(7*r)),yt=Math.max(10,Math.round(12*r));t.font=`${ft}px monospace`,t.textBaseline="top",t.fillStyle="#e8e8e8";const Z=S+M+l,gt=I,wt=d+f-l-Z;Jt(t,this.content,Math.round(Z),Math.round(gt),wt,yt),t.fillStyle="#212121";const D=i+o,Q=Math.min(P,D+20),tt=Math.max(3,Math.round(4*r)),bt=e+Math.round(s*.22),St=e+Math.round(s*.78);t.fillRect(bt,D,tt,Q-D),t.fillRect(St,D,tt,Q-D)}}const q=[{id:"intro",title:"INTRODUCTION",content:"HI! My name is Aidan and I'm currently learning how to work with html and css canvases. This is my first website, so pls be nice and I hope you like it!",triggerX:E(13),boxY:P-50,billboardOffset:{x:-110,y:-80},imageKey:"bbIntro"},{id:"about",title:"ABOUT ME",content:"I'm currently in my second year as a Computer Science student in UNSW! I strive to be the best worker McDonald's has ever seen once I graduate, so pls wish me luck!",triggerX:E(43),boxY:P-50,billboardOffset:{x:-110,y:-80},imageKey:"bbAbout"},{id:"projects",title:"RECENT PROJECTS",content:"I created a mobile fitness app which encourages users to stay fit using a post-workout selfie feature (a bit like Strava X beReal)",triggerX:E(73),boxY:P-50,billboardOffset:{x:-110,y:-80},imageKey:"bbProjects"},{id:"hobbies",title:"HOBBIES",content:"I love climbing and playing the guitar. Havn't been climbing much lately but I really want to get back into it!",triggerX:E(103),boxY:P-50,billboardOffset:{x:-110,y:-80},imageKey:"bbHobbies"},{id:"games",title:"GAMES",content:"I also love playing games! Playing games like mario and metal slug growing up is what inspired me to make this game concept!",triggerX:E(133),boxY:P-50,billboardOffset:{x:-110,y:-80},imageKey:"bbGames"}];function Qt(n){return q.find(t=>t.id===n)}function C(n){return Math.max(0,Math.min(1,n))}const k=[{p:0,top:[110,190,255],bot:[200,235,255]},{p:.25,top:[30,110,220],bot:[70,155,240]},{p:.5,top:[255,130,40],bot:[255,200,80]},{p:.7,top:[100,30,140],bot:[170,80,190]},{p:1,top:[5,8,30],bot:[15,25,70]}],te=Array.from({length:6},(n,t)=>({x:t/6*ct+Math.random()*40,y:18+Math.random()*35,w:28+Math.floor(Math.random()*24),h:7+Math.floor(Math.random()*6)})),ee=Array.from({length:60},()=>({x:Math.random()*ct,y:Math.random()*(Xt*.55),size:Math.random()<.7?1:2,phase:Math.random()*Math.PI*2,speed:.004+Math.random()*.003}));class ie{constructor(){this.heroX=0,this.progress=0,this.progressSmooth=0,this.time=0,g.on("HERO_POSITION",this,t=>{this.heroX=t.x,this.progress=C(this.heroX/G)})}step(t){this.time+=t}draw(t,e=0){const i=t.canvas.width,s=t.canvas.height,o=-e;this.progressSmooth+=(this.progress-this.progressSmooth)*.06;const r=this.progressSmooth,{top:a,bot:h}=se(r),c=t.createLinearGradient(0,0,0,s);if(c.addColorStop(0,nt(a)),c.addColorStop(1,nt(h)),t.fillStyle=c,t.fillRect(0,0,i,s),r>.35&&r<.88){const p=r<.55?(r-.35)/.2:1-(r-.55)/.25,f=t.createLinearGradient(0,s*.55,0,s);f.addColorStop(0,"rgba(255,120,30,0)"),f.addColorStop(1,`rgba(255,80,0,${(p*.28).toFixed(3)})`),t.fillStyle=f,t.fillRect(0,s*.55,i,s*.45)}const l=Math.max(0,Math.min(1,(r-.5)/.2));if(l>0){t.save(),t.fillStyle="#fff";const f=-o*.03%i;for(const m of ee){const w=.8+.2*Math.sin(this.time*m.speed+m.phase);t.globalAlpha=l*w;let b=m.x+f;b=(b%i+i)%i,t.fillRect(b,m.y,m.size,m.size)}t.restore()}const d=Math.max(0,1-(r-.4)/.2);if(d>0){t.save(),t.globalAlpha=d;const f=-o*.13%i;t.fillStyle="rgba(255,255,255,0.88)";for(const m of te){let w=m.x+f;w=(w%(i+m.w)+(i+m.w))%(i+m.w)-m.w;const b=m.y,M=m.w,S=m.h;t.fillRect(w,b+Math.floor(S*.4),M,Math.ceil(S*.6));const I=Math.floor(M*.38),T=Math.floor(M*.32);t.fillRect(w+Math.floor(M*.12),b,I,S),t.fillRect(w+Math.floor(M*.54),b+Math.floor(S*.18),T,Math.ceil(S*.82))}t.restore()}}}function z(n,t,e){return n+(t-n)*e}function ot(n,t,e){return[Math.round(z(n[0],t[0],e)),Math.round(z(n[1],t[1],e)),Math.round(z(n[2],t[2],e))]}function nt(n){return`rgb(${n[0]},${n[1]},${n[2]})`}function se(n){let t=k[0],e=k[k.length-1];for(let o=0;o<k.length-1;o++)if(n>=k[o].p&&n<=k[o+1].p){t=k[o],e=k[o+1];break}const i=e.p-t.p||1,s=(n-t.p)/i;return{top:ot(t.top,e.top,s),bot:ot(t.bot,e.bot,s)}}const rt=.5,j=.5;class oe{constructor(){this.time=0,this.progress=0,this.progressSmooth=0,this.heroX=0,g.on("HERO_POSITION",this,t=>{this.heroX=t.x})}step(t){this.time+=t}draw(t,e,i){this.progress=C(this.heroX/G),this.progressSmooth+=(this.progress-this.progressSmooth)*.1;const s=this.progressSmooth;if(s<=rt){const o=C(s/rt);this.drawSun(t,e,i,o,s)}else{const o=C((s-j)/(1-j));this.drawMoon(t,e,i,o,s)}}drawSun(t,e,i,s,o){const h=e*(.9-.8*s),c=i*.85-Math.sin(s*Math.PI)*i*.6,l=o>.5?C(1-(o-.5)/.15):1;t.save(),t.globalAlpha=l;const d=18,p=t.createRadialGradient(h,c,2,h,c,d);p.addColorStop(0,"rgba(255,245,180,0.55)"),p.addColorStop(1,"rgba(255,200,50,0)"),t.fillStyle=p,t.fillRect(h-d,c-d,d*2,d*2);const f=Math.round(h),m=Math.round(c);t.fillStyle="#ffffc0",t.fillRect(f-4,m-4,8,8),t.fillRect(f-6,m-2,2,4),t.fillRect(f+4,m-2,2,4),t.fillRect(f-2,m-6,4,2),t.fillRect(f-2,m+4,4,2),t.restore()}drawMoon(t,e,i,s,o){const h=e*(.9-.8*s),c=i*.85-Math.sin(s*Math.PI)*i*.6,l=C((o-j)/.1);t.save(),t.globalAlpha=l;const d=Math.round(h),p=Math.round(c);t.fillStyle="#d8eeff",t.fillRect(d-4,p-4,8,8),t.fillRect(d-3,p-5,6,1),t.fillRect(d-3,p+4,6,1),t.fillRect(d-5,p-3,1,6),t.fillRect(d+4,p-3,1,6),t.restore()}}class ne{constructor(){this.parallax=.22,this.horizonYRatio=.88,this.patternWidth=420,this.pattern=[{x:10,w:40,h:50,body:"#7b848c",top:"#555c63"},{x:60,w:70,h:75,body:"#9aa0a6",top:"#2f3338",label:"UNSW"},{x:150,w:50,h:60,body:"#6f7880",top:"#4f565d"},{x:220,w:60,h:55,body:"#808a93",top:"#5b636a"},{x:300,w:45,h:48,body:"#6b747c",top:"#4b5258"}]}draw(t,e){const i=t.canvas.width,s=t.canvas.height,o=-e,r=Math.floor(s*this.horizonYRatio);let a=o*this.parallax;a=(a%this.patternWidth+this.patternWidth)%this.patternWidth,t.save(),t.globalAlpha=1;for(let h=-this.patternWidth;h<i+this.patternWidth;h+=this.patternWidth){const c=h-a;for(const l of this.pattern){const d=Math.round(c+l.x),p=Math.round(r-l.h);t.fillStyle=l.body,t.fillRect(d,p,l.w,l.h),t.fillStyle=l.top,t.fillRect(d,p,l.w,16),t.fillStyle="rgba(0,0,0,0.35)";const f=8,m=3,w=3,b=8,M=8;for(let S=p+26;S<p+l.h-f;S+=M)for(let I=d+f;I<d+l.w-f;I+=b)t.fillRect(I,S,m,w);l.label&&(t.fillStyle="#ffffff",t.textAlign="center",t.textBaseline="middle",t.font='12px "Press Start 2P", monospace',t.fillText(l.label,d+l.w/2,p+8))}}t.restore()}}class re extends v{constructor(t,e){super({position:new u(t,e)}),this.w=18,this.h=14,this.triggerW=16,this.triggerH=10,this.triggered=!1,this.drawLayer=2,g.on("HERO_POSITION",this,i=>{if(this.triggered)return;const s=i.x,o=i.y,r=this.position.x-this.triggerW/2,a=this.position.x+this.triggerW/2,h=this.position.y-this.triggerH,c=this.position.y;s>=r&&s<=a&&o>=h&&o<=c&&(this.triggered=!0,g.emit("SHOW_TUTORIAL"))})}drawImage(t,e,i){const s=Math.round(e),o=Math.round(i);t.fillStyle="#6b4a2b",t.fillRect(s-1,o-8,2,10),t.fillStyle="rgba(0,0,0,0.25)",t.fillRect(s,o-8,1,10),t.fillStyle="#a0723a",t.fillRect(s-9,o-16,18,10),t.fillStyle="#6b4a2b",t.fillRect(s-9,o-16,18,1),t.fillRect(s-9,o-7,18,1),t.fillRect(s-9,o-16,1,10),t.fillRect(s+8,o-16,1,10),t.fillStyle="rgba(0,0,0,0.35)",t.fillRect(s-6,o-13,12,1),t.fillRect(s-6,o-11,10,1),t.fillRect(s-6,o-9,8,1)}}class ae{constructor({rootId:t="start-screen",startBtnId:e="btn-start",skipBtnId:i="btn-skip",secretBtnId:s="btn-secret",secretScreenId:o="secret-screen",secretBackId:r="secret-back",cloudLayerId:a="cloud-layer",tipId:h="daily-tip"}={}){this.root=document.getElementById(t),this.btnStart=document.getElementById(e),this.btnSkip=document.getElementById(i),this.btnSecret=document.getElementById(s),this.secretScreen=document.getElementById(o),this.secretBack=document.getElementById(r),this.cloudLayer=document.getElementById(a),this.tipEl=document.getElementById(h),this.isVisible=!0,this.tips=["Aidan's Tip: Use desktop to play interactive browser portfolio game, so cool! Wow!","Aidan's Tip: Might not be mobile compatible yet sorry","Aidan's Tip: Use desktop for full immersive experience, very wow!!"],this.wireEvents(),this.spawnClouds(8),this.setRandomTip()}wireEvents(){this.btnStart&&this.btnStart.addEventListener("click",()=>{g.emit("START_GAME")}),this.btnSkip&&this.btnSkip.addEventListener("click",()=>{console.log("Skip clicked"),g.emit("SKIP_GAME")}),this.btnSecret&&this.btnSecret.addEventListener("click",()=>{this.showSecret()}),this.secretBack&&this.secretBack.addEventListener("click",()=>{this.hideSecret()})}showSecret(){this.secretScreen&&(this.secretScreen.classList.remove("hidden"),this.secretScreen.setAttribute("aria-hidden","false"))}hideSecret(){this.secretScreen&&(this.secretScreen.classList.add("hidden"),this.secretScreen.setAttribute("aria-hidden","true"))}show(){this.root&&(this.root.classList.remove("hidden"),this.isVisible=!0)}hide(){this.root&&(this.root.classList.add("hidden"),this.isVisible=!1)}setRandomTip(){if(!this.tipEl)return;const t=this.tips[Math.floor(Math.random()*this.tips.length)];this.tipEl.textContent=t}spawnClouds(t=8){if(this.cloudLayer){this.cloudLayer.innerHTML="";for(let e=0;e<t;e++){const i=this.makeCloud(e%3);i.style.top=`${10+Math.random()*60}%`,i.style.left=`${-200-Math.random()*600}px`;const s=.5+Math.random()*1.4;i.style.transform=`scale(${s})`;const o=20+Math.random()*40;i.style.animationDuration=`${o}s`;const r=-Math.random()*40;i.style.animationDelay=`${r}s`,this.cloudLayer.appendChild(i)}}}makeCloud(t=0){const e=document.createElement("div");e.className="cloud",e.style.width="160px",e.style.height="60px",e.style.background="#ffffff",e.style.borderRadius="10px",e.style.opacity="0.6";const i=t===0?[{x:22,y:10,w:50,h:18},{x:70,y:0,w:60,h:22}]:t===1?[{x:12,y:14,w:60,h:18},{x:78,y:6,w:50,h:20}]:[{x:28,y:6,w:46,h:18},{x:82,y:10,w:56,h:18}];for(const s of i){const o=document.createElement("div");o.style.position="absolute",o.style.left=`${s.x}px`,o.style.top=`${s.y}px`,o.style.width=`${s.w}px`,o.style.height=`${s.h}px`,o.style.background="#ffffff",o.style.borderRadius="8px",e.appendChild(o)}return e.style.position="absolute",e.style.animationName="cloudFloat",e.style.animationTimingFunction="linear",e.style.animationIterationCount="infinite",e}}class he{constructor({input:t,mouse:e,canvas:i}){this.input=t,this.mouse=e,this.canvas=i,this._isPaused=!1}get isPaused(){return this._isPaused}setPaused(t){this._isPaused=t,this.input.clearFrameInputs(),this.mouse.clearFrameInputs(),t?(this.mouse.isDown=!1,this.mouse.pressed=!1,this.mouse.released=!1,this.canvas.style.cursor="default"):this.canvas.style.cursor="none"}}class le{constructor({pauseManager:t}){this.pauseManager=t,this.modal=document.getElementById("tutorial-modal"),this.closeBtn=document.getElementById("tutorial-close"),this.wireEvents()}wireEvents(){this.closeBtn&&this.closeBtn.addEventListener("click",()=>this.hide()),window.addEventListener("keydown",t=>{this.pauseManager.isPaused&&t.code==="Escape"&&this.hide()})}show(){this.modal&&(this.modal.classList.remove("hidden"),this.modal.setAttribute("aria-hidden","false"),this.pauseManager.setPaused(!0))}hide(){this.modal&&(this.modal.classList.add("hidden"),this.modal.setAttribute("aria-hidden","true"),this.pauseManager.setPaused(!1))}}class de{constructor(){this.byId=new Map(q.map(t=>[t.id,t])),this.introP=document.getElementById("p-intro-text"),this.aboutP=document.getElementById("p-about-text"),this.hobbiesP=document.getElementById("p-hobbies-text"),this.gamesP=document.getElementById("p-games-text"),this.projectsGrid=document.getElementById("projects-grid"),this.render(),this.wireNav(),this.wireContactForm()}render(){const t=this.byId.get("intro");t&&this.introP&&(this.introP.textContent=t.content);const e=this.byId.get("about");e&&this.aboutP&&(this.aboutP.textContent=e.content);const i=this.byId.get("hobbies");i&&this.hobbiesP&&(this.hobbiesP.textContent=i.content);const s=this.byId.get("projects");if(s&&this.projectsGrid){this.projectsGrid.innerHTML="";const r=document.createElement("article");r.className="pixel-box",r.innerHTML=`
                <h3 class="pixel-h3">${s.title}</h3>
                <p class="pixel-text">${s.content}</p>
            `,this.projectsGrid.appendChild(r)}const o=this.byId.get("games");o&&this.gamesP&&(this.gamesP.textContent=o.content)}wireNav(){document.querySelectorAll("[data-jump]").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-jump");document.querySelector(e)?.scrollIntoView({behavior:"smooth"})})})}wireContactForm(){const t=document.getElementById("contact-form");t&&t.addEventListener("submit",e=>{e.preventDefault(),alert("Doesn't actually work, havn't implemented this yet lol (Coming soon!)"),t.reset()})}}class ce{constructor({pauseManager:t}){this.pauseManager=t,this.modal=document.getElementById("pipe-modal"),this.skipBtn=document.getElementById("pipe-skip"),this.skipBtn&&this.skipBtn.addEventListener("click",()=>{this.hide(),g.emit("SKIP_GAME")})}show(){this.modal&&(this.modal.classList.remove("hidden"),this.modal.setAttribute("aria-hidden","false"),this.pauseManager.setPaused(!0))}hide(){this.modal&&(this.modal.classList.add("hidden"),this.modal.setAttribute("aria-hidden","true"))}}class pe extends v{constructor(t,e){super({position:new u(t,e)}),this.w=34,this.h=34,this.entranceW=18,this.entranceH=6,this.triggered=!1,this.drawLayer=2}step(t,e){if(this.triggered)return;const i=e?.hero;if(!i||!i.justLanded)return;const s=this.position.x,o=i.position.x,r=i.position.y;if(!(Math.abs(r-P)<=1)||!(o>=s-this.entranceW/2&&o<=s+this.entranceW/2))return;this.triggered=!0;const c=10,d=this.position.y-this.h-c+2+c-8;i.enterPipe(s,d),setTimeout(()=>{g.emit("PIPE_FOUND")},850)}drawImage(t,e,i){const s=Math.round(e),o=Math.round(i),r=this.w,a=this.h,h="#0a6a2a",c="#18a84a",l="#33d06a",d="#1dd65c";t.fillStyle=h,t.fillRect(s-r/2,o-a,r,a),t.fillStyle=c,t.fillRect(s-r/2+3,o-a+3,r-6,a-6),t.fillStyle=l,t.fillRect(s-r/2+3,o-a+3,5,a-6);const p=10,f=o-a-p+2;t.fillStyle=d,t.fillRect(s-r/2-2,f,r+4,p),t.fillStyle=h,t.fillRect(s-r/2-2,f,r+4,2)}}const H=document.querySelector("#game-canvas"),L=H.getContext("2d");L.imageSmoothingEnabled=!1;const $=document.getElementById("portfolio-page"),pt=new ie,ut=new oe,ue=new ne,y=new v({position:new u(0,0)});y.input=new Pt;const X=new Nt(H);y.mouse=X;const x=new he({input:y.input,mouse:X,canvas:H}),me=new le({pauseManager:x}),fe=new ce({pauseManager:x}),J=new ae;x.setPaused(!0);J.show();g.on("START_GAME",y,()=>{J.hide(),$?.classList.add("hidden"),document.body.classList.remove("allow-scroll"),x.setPaused(!1)});new de;g.on("SKIP_GAME",y,()=>{J.hide(),$?.classList.remove("hidden"),document.body.classList.add("allow-scroll"),x.setPaused(!0),H.style.cursor="default",$?.scrollIntoView({behavior:"smooth"})});const W=new _t;y.addChild(W);y.camera=W;const ye=new Gt;y.addChild(ye);const mt=new Bt(V,P-200);y.addChild(mt);y.hero=mt;const ge=new Ft(E(6),P);y.addChild(ge);const we=new re(E(3),P);y.addChild(we);const be=new pe(G-E(4),P);y.addChild(be);g.on("SPAWN_BULLET",y,({position:n,velocity:t})=>{y.addChild(new zt({position:n,velocity:t,lifeMs:900}))});const at=new Set;q.forEach(n=>{const t=new $t(n.triggerX,n.boxY??P-40,n.id);y.addChild(t)});g.on("BOX_EXPLODE",y,({x:n,y:t,sectionId:e})=>{if(at.has(e))return;at.add(e),y.addChild(new qt(n,t,"#ffcc00"));const i=Qt(e);if(!i)return;const s=i.billboardOffset?.x??-110,o=i.billboardOffset?.y??-80,r=new Zt(Math.round(n+s),Math.round(t+o));r.title=i.title,r.content=i.content,r.imageKey=i.imageKey,y.addChild(r)});g.on("SHOW_TUTORIAL",y,()=>{me.show()});g.on("PIPE_FOUND",y,()=>{fe.show()});const Se=n=>{if(X.updateWorld(W),x.isPaused){y.input.clearFrameInputs(),X.clearFrameInputs();return}y.stepEntry(n,y),pt.step(n),ut.step(n),y.input.clearFrameInputs(),X.clearFrameInputs()},Me=()=>{const n=L.canvas.width,t=L.canvas.height;L.clearRect(0,0,H.width,H.height),pt.draw(L,W.position.x),ut.draw(L,n,t),ue.draw(L,W.position.x),L.save(),L.translate(W.position.x,W.position.y),y.draw(L,0,0),L.restore(),x.isPaused||Kt(L,X)},Pe=new Mt(Se,Me);Pe.start();
